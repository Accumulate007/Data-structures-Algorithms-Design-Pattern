<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>状态模式</title>
</head>
<body>

<script>
/**
 *状态模式(State Pattern): 允许一个对象在其内部状态改变的时候改变其行为，类的行为随着它的状态改变而改变。
 *
 *
*/

class AbstractState {
  constructor() {
    if(new.target === AbstractState) {
      throw new Error('抽象类无法直接实例化');
    }
  }

  employ() {
    throw new Error('抽象方法无法调用');
  }
}

class State extends AbstractState {
  constructor(name, desc) {
    super();
    this.color = {name, desc};
  }

  employ(trafficLight) {
    trafficLight.setState(this);
  }
}

class TrafficLight {
  constructor() {
    this.state = null;
  }

  getState() {
    return this.state;
  }

  setState(state) {
    this.state = state;
  }
}

const trafficLight = new TrafficLight();
const redState = new State('red', 'please wait...');

// 新建另一个状态
const blueState = new State('blue', 'no this color~~');

</script>
</body>
</html>
